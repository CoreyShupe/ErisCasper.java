<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GuildManagerUpdatable.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ErisCasper.java</a> &gt; <a href="index.source.html" class="el_package">net.dv8tion.jda.core.managers</a> &gt; <span class="el_source">GuildManagerUpdatable.java</span></div><h1>GuildManagerUpdatable.java</h1><pre class="source lang-java linenums">/*
 *     Copyright 2015-2018 Austin Keener &amp; Michael Ritter &amp; Florian Spie√ü
 *     Copyright 2018-2018 &quot;Princess&quot; Lana Samson
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package net.dv8tion.jda.core.managers;

import net.dv8tion.jda.core.JDA;
import net.dv8tion.jda.core.Permission;
import net.dv8tion.jda.core.Region;
import net.dv8tion.jda.core.entities.Guild;
import net.dv8tion.jda.core.entities.Icon;
import net.dv8tion.jda.core.entities.TextChannel;
import net.dv8tion.jda.core.entities.VoiceChannel;
import net.dv8tion.jda.core.exceptions.GuildUnavailableException;
import net.dv8tion.jda.core.exceptions.InsufficientPermissionException;
import net.dv8tion.jda.core.managers.fields.GuildField;
import net.dv8tion.jda.core.requests.Request;
import net.dv8tion.jda.core.requests.Response;
import net.dv8tion.jda.core.requests.Route;
import net.dv8tion.jda.core.requests.restaction.AuditableRestAction;
import net.dv8tion.jda.core.utils.Checks;
import org.json.JSONObject;

/**
 * An {@link #update() updatable} manager that allows to modify guild settings like the {@link
 * #getNameField() name} or the {@link #getSplashField() splash}.
 *
 * &lt;p&gt;This manager allows to modify multiple fields at once by getting the {@link
 * net.dv8tion.jda.core.managers.fields.GuildField GuildField} for specific properties and setting
 * or resetting their values; followed by a call of {@link #update()}!
 *
 * &lt;p&gt;The {@link net.dv8tion.jda.core.managers.GuildManager GuildManager} implementation simplifies
 * this process by giving simple setters that return the {@link #update() update} {@link
 * net.dv8tion.jda.core.requests.RestAction RestAction}
 *
 * &lt;p&gt;&lt;b&gt;Note&lt;/b&gt;: To {@link #update() update} this manager the currently logged in account requires
 * the Permission {@link net.dv8tion.jda.core.Permission#MANAGE_SERVER MANAGE_SERVER}
 *
 * &lt;p&gt;&lt;b&gt;To use moderation abilities like creating Roles or banning Members use {@link
 * net.dv8tion.jda.core.managers.GuildController GuildController}&lt;/b&gt;
 */
public class GuildManagerUpdatable {
  protected final Guild guild;

  protected GuildField&lt;String&gt; name;
  protected GuildField&lt;Icon&gt; icon;
  protected GuildField&lt;Icon&gt; splash;
  protected GuildField&lt;Region&gt; region;
  protected GuildField&lt;VoiceChannel&gt; afkChannel;
  protected GuildField&lt;TextChannel&gt; systemChannel;
  protected GuildField&lt;Guild.VerificationLevel&gt; verificationLevel;
  protected GuildField&lt;Guild.NotificationLevel&gt; defaultNotificationLevel;
  protected GuildField&lt;Guild.MFALevel&gt; mfaLevel;
  protected GuildField&lt;Guild.ExplicitContentLevel&gt; explicitContentLevel;
  protected GuildField&lt;Guild.Timeout&gt; timeout;

  /**
   * Creates a new GuildManagerUpdatable instance
   *
   * @param guild The {@link net.dv8tion.jda.core.entities.Guild Guild} that should be modified
   */
<span class="nc" id="L74">  public GuildManagerUpdatable(Guild guild) {</span>
<span class="nc" id="L75">    this.guild = guild;</span>
<span class="nc" id="L76">    setupFields();</span>
<span class="nc" id="L77">  }</span>

  /**
   * The {@link net.dv8tion.jda.core.JDA JDA} instance of this Manager
   *
   * @return the corresponding JDA instance
   */
  public JDA getJDA() {
<span class="nc" id="L85">    return guild.getJDA();</span>
  }

  /**
   * The {@link net.dv8tion.jda.core.entities.Guild Guild} object of this Manager. Useful if this
   * Manager was returned via a create function
   *
   * @return The {@link net.dv8tion.jda.core.entities.Guild Guild} of this Manager
   */
  public Guild getGuild() {
<span class="nc" id="L95">    return guild;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the
   * &lt;b&gt;&lt;u&gt;name&lt;/u&gt;&lt;/b&gt; of the selected {@link net.dv8tion.jda.core.entities.Guild Guild}.
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(String)} on the returned {@link net.dv8tion.jda.core.managers.fields.GuildField
   * GuildField} instance.
   *
   * &lt;p&gt;A guild name &lt;b&gt;must not&lt;/b&gt; be {@code null} nor less than 2 characters or more than 100
   * characters long! &lt;br&gt;
   * Otherwise {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * Field.setValue(...)} will throw an {@link IllegalArgumentException IllegalArgumentException}.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@code
   *     String}
   */
  public GuildField&lt;String&gt; getNameField() {
<span class="nc" id="L117">    checkAvailable();</span>

<span class="nc" id="L119">    return name;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the {@link
   * net.dv8tion.jda.core.Region Region} of the selected {@link net.dv8tion.jda.core.entities.Guild
   * Guild}.
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(Region)} on the returned {@link net.dv8tion.jda.core.managers.fields.GuildField
   * GuildField} instance.
   *
   * &lt;p&gt;A guild region &lt;b&gt;must not&lt;/b&gt; be {@code null} nor {@link
   * net.dv8tion.jda.core.Region#UNKNOWN Region.UNKNOWN}! &lt;br&gt;
   * Otherwise {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * Field.setValue(...)} will throw an {@link IllegalArgumentException IllegalArgumentException}.
   *
   * &lt;p&gt;{@link net.dv8tion.jda.core.Region#isVip() VIP regions} are only allowed if supported by the
   * Guild. Use {@link net.dv8tion.jda.core.entities.Guild#getFeatures() Guild#getFeatures()} to
   * check if VIP regions are supported. &lt;br&gt;
   * If a VIP region is supplied to a Guild that doesn't support VIP regions, {@link
   * net.dv8tion.jda.core.managers.fields.Field#setValue(Object) Field.setValue(...)} will throw an
   * {@link IllegalArgumentException IllegalArgumentException}.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@link
   *     net.dv8tion.jda.core.Region Region}
   */
  public GuildField&lt;Region&gt; getRegionField() {
<span class="nc" id="L149">    checkAvailable();</span>

<span class="nc" id="L151">    return region;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the {@link
   * net.dv8tion.jda.core.entities.Icon Icon} of the selected {@link
   * net.dv8tion.jda.core.entities.Guild Guild}. &lt;br&gt;
   * To reset the Icon of a Guild provide {@code null} to {@link
   * net.dv8tion.jda.core.managers.fields.Field#setValue(Object) setValue(Icon)}.
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(Icon)} on the returned {@link net.dv8tion.jda.core.managers.fields.GuildField
   * GuildField} instance.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@link
   *     net.dv8tion.jda.core.entities.Icon Icon}
   */
  public GuildField&lt;Icon&gt; getIconField() {
<span class="nc" id="L171">    checkAvailable();</span>

<span class="nc" id="L173">    return icon;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the &lt;b&gt;&lt;u&gt;splash
   * {@link net.dv8tion.jda.core.entities.Icon Icon}&lt;/u&gt;&lt;/b&gt; of the selected {@link
   * net.dv8tion.jda.core.entities.Guild Guild}. &lt;br&gt;
   * To reset the splash of a Guild provide {@code null} to {@link
   * net.dv8tion.jda.core.managers.fields.Field#setValue(Object) setValue(Icon)}.
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(Icon)} on the returned {@link net.dv8tion.jda.core.managers.fields.GuildField
   * GuildField} instance.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@link
   *     net.dv8tion.jda.core.entities.Icon Icon}
   */
  public GuildField&lt;Icon&gt; getSplashField() {
<span class="nc" id="L193">    checkAvailable();</span>

<span class="nc" id="L195">    return splash;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the &lt;b&gt;&lt;u&gt;AFK {@link
   * net.dv8tion.jda.core.entities.VoiceChannel VoiceChannel}&lt;/u&gt;&lt;/b&gt; of the selected {@link
   * net.dv8tion.jda.core.entities.Guild Guild}. &lt;br&gt;
   * To reset the channel of a Guild provide {@code null} to {@link
   * net.dv8tion.jda.core.managers.fields.Field#setValue(Object) setValue(VoiceChannel)}.
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(VoiceChannel)} on the returned {@link net.dv8tion.jda.core.managers.fields.GuildField
   * GuildField} instance.
   *
   * &lt;p&gt;A guild afk channel &lt;b&gt;must&lt;/b&gt; be from this Guild! &lt;br&gt;
   * Otherwise {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * Field.setValue(...)} will throw an {@link IllegalArgumentException IllegalArgumentException}.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@link
   *     net.dv8tion.jda.core.entities.VoiceChannel VoiceChannel}
   */
  public GuildField&lt;VoiceChannel&gt; getAfkChannelField() {
<span class="nc" id="L219">    checkAvailable();</span>

<span class="nc" id="L221">    return afkChannel;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the &lt;b&gt;&lt;u&gt;system
   * {@link net.dv8tion.jda.core.entities.TextChannel TextChannel}&lt;/u&gt;&lt;/b&gt; of the selected {@link
   * net.dv8tion.jda.core.entities.Guild Guild}. &lt;br&gt;
   * To reset the channel of a Guild provide {@code null} to {@link
   * net.dv8tion.jda.core.managers.fields.Field#setValue(Object) setValue(VoiceChannel)}.
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(TextChannel)} on the returned {@link net.dv8tion.jda.core.managers.fields.GuildField
   * GuildField} instance.
   *
   * &lt;p&gt;A guild system channel &lt;b&gt;must&lt;/b&gt; be from this Guild! &lt;br&gt;
   * Otherwise {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * Field.setValue(...)} will throw an {@link IllegalArgumentException IllegalArgumentException}.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@link
   *     net.dv8tion.jda.core.entities.TextChannel TextChannel}
   */
  public GuildField&lt;TextChannel&gt; getSystemChannelField() {
<span class="nc" id="L245">    checkAvailable();</span>

<span class="nc" id="L247">    return systemChannel;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the &lt;b&gt;&lt;u&gt;AFK {@link
   * net.dv8tion.jda.core.entities.Guild.Timeout Timeout}&lt;/u&gt;&lt;/b&gt; of the selected {@link
   * net.dv8tion.jda.core.entities.Guild Guild}. &lt;br&gt;
   * Valid timeouts (in seconds) are 60, 300, 900, 1800, 3600. Default value is {@code 300} (5
   * minutes)
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(Guild.Timeout)} on the returned {@link net.dv8tion.jda.core.managers.fields.GuildField
   * GuildField} instance.
   *
   * &lt;p&gt;A guild afk timeout &lt;b&gt;must not&lt;/b&gt; be {@code null}! &lt;br&gt;
   * Otherwise {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * Field.setValue(...)} will throw an {@link IllegalArgumentException IllegalArgumentException}.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@link
   *     net.dv8tion.jda.core.entities.Guild.Timeout Guild.Timeout}
   */
  public GuildField&lt;Guild.Timeout&gt; getAfkTimeoutField() {
<span class="nc" id="L271">    checkAvailable();</span>

<span class="nc" id="L273">    return timeout;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the &lt;b&gt;&lt;u&gt;{@link
   * net.dv8tion.jda.core.entities.Guild.VerificationLevel Verification Level}&lt;/u&gt;&lt;/b&gt; of the
   * selected {@link net.dv8tion.jda.core.entities.Guild Guild}. &lt;br&gt;
   * The default value is {@link net.dv8tion.jda.core.entities.Guild.VerificationLevel#NONE NONE}
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(Guild.VerificationLevel)} on the returned {@link
   * net.dv8tion.jda.core.managers.fields.GuildField GuildField} instance.
   *
   * &lt;p&gt;A guild verification level &lt;b&gt;must not&lt;/b&gt; be {@code null} or {@link
   * net.dv8tion.jda.core.entities.Guild.VerificationLevel#UNKNOWN UNKNOWN}! &lt;br&gt;
   * Otherwise {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * Field.setValue(...)} will throw an {@link IllegalArgumentException IllegalArgumentException}.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@link
   *     net.dv8tion.jda.core.entities.Guild.VerificationLevel Guild.VerificationLevel}
   */
  public GuildField&lt;Guild.VerificationLevel&gt; getVerificationLevelField() {
<span class="nc" id="L297">    checkAvailable();</span>

<span class="nc" id="L299">    return verificationLevel;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the &lt;b&gt;&lt;u&gt;{@link
   * net.dv8tion.jda.core.entities.Guild.NotificationLevel Notification Level}&lt;/u&gt;&lt;/b&gt; of the
   * selected {@link net.dv8tion.jda.core.entities.Guild Guild}. &lt;br&gt;
   * The default value is {@link net.dv8tion.jda.core.entities.Guild.NotificationLevel#ALL_MESSAGES
   * ALL_MESSAGES}
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(Guild.NotificationLevel)} on the returned {@link
   * net.dv8tion.jda.core.managers.fields.GuildField GuildField} instance.
   *
   * &lt;p&gt;A guild notification level &lt;b&gt;must not&lt;/b&gt; be {@code null} or {@link
   * net.dv8tion.jda.core.entities.Guild.NotificationLevel#UNKNOWN UNKNOWN}! &lt;br&gt;
   * Otherwise {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * Field.setValue(...)} will throw an {@link IllegalArgumentException IllegalArgumentException}.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@link
   *     net.dv8tion.jda.core.entities.Guild.NotificationLevel Guild.NotificationLevel}
   */
  public GuildField&lt;Guild.NotificationLevel&gt; getDefaultNotificationLevelField() {
<span class="nc" id="L324">    checkAvailable();</span>

<span class="nc" id="L326">    return defaultNotificationLevel;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the &lt;b&gt;&lt;u&gt;{@link
   * net.dv8tion.jda.core.entities.Guild.MFALevel MFA Level}&lt;/u&gt;&lt;/b&gt; of the selected {@link
   * net.dv8tion.jda.core.entities.Guild Guild}. &lt;br&gt;
   * The default value is {@link net.dv8tion.jda.core.entities.Guild.MFALevel#NONE NONE}
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(Guild.MFALevel)} on the returned {@link
   * net.dv8tion.jda.core.managers.fields.GuildField GuildField} instance.
   *
   * &lt;p&gt;A guild mfa level &lt;b&gt;must not&lt;/b&gt; be {@code null} or {@link
   * net.dv8tion.jda.core.entities.Guild.MFALevel#UNKNOWN UNKNOWN}! &lt;br&gt;
   * Otherwise {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * Field.setValue(...)} will throw an {@link IllegalArgumentException IllegalArgumentException}.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@link
   *     net.dv8tion.jda.core.entities.Guild.MFALevel Guild.MFALevel}
   */
  public GuildField&lt;Guild.MFALevel&gt; getRequiredMFALevelField() {
<span class="nc" id="L350">    checkAvailable();</span>
<span class="nc" id="L351">    return mfaLevel;</span>
  }

  /**
   * An {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} for the &lt;b&gt;&lt;u&gt;{@link
   * net.dv8tion.jda.core.entities.Guild.ExplicitContentLevel Explicit Content Level}&lt;/u&gt;&lt;/b&gt; of the
   * selected {@link net.dv8tion.jda.core.entities.Guild Guild}. &lt;br&gt;
   * The default value is {@link net.dv8tion.jda.core.entities.Guild.ExplicitContentLevel#OFF OFF}
   *
   * &lt;p&gt;To set the value use {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * setValue(Guild.ExplicitContentLevel)} on the returned {@link
   * net.dv8tion.jda.core.managers.fields.GuildField GuildField} instance.
   *
   * &lt;p&gt;A guild explicit content level &lt;b&gt;must not&lt;/b&gt; be {@code null} or {@link
   * net.dv8tion.jda.core.entities.Guild.ExplicitContentLevel#UNKNOWN UNKNOWN}! &lt;br&gt;
   * Otherwise {@link net.dv8tion.jda.core.managers.fields.Field#setValue(Object)
   * Field.setValue(...)} will throw an {@link IllegalArgumentException IllegalArgumentException}.
   *
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.managers.fields.GuildField GuildField} - Type: {@link
   *     net.dv8tion.jda.core.entities.Guild.ExplicitContentLevel Guild.ExplicitContentLevel}
   */
  public GuildField&lt;Guild.ExplicitContentLevel&gt; getExplicitContentLevelField() {
<span class="nc" id="L375">    checkAvailable();</span>
<span class="nc" id="L376">    return explicitContentLevel;</span>
  }

  /**
   * Resets all queued updates. So the next call to {@link #update()} will change nothing. &lt;br&gt;
   * This is automatically called by {@link #update()}
   */
  public void reset() {
<span class="nc" id="L384">    this.name.reset();</span>
<span class="nc" id="L385">    this.region.reset();</span>
<span class="nc" id="L386">    this.timeout.reset();</span>
<span class="nc" id="L387">    this.icon.reset();</span>
<span class="nc" id="L388">    this.splash.reset();</span>
<span class="nc" id="L389">    this.afkChannel.reset();</span>
<span class="nc" id="L390">    this.systemChannel.reset();</span>
<span class="nc" id="L391">    this.verificationLevel.reset();</span>
<span class="nc" id="L392">    this.defaultNotificationLevel.reset();</span>
<span class="nc" id="L393">    this.mfaLevel.reset();</span>
<span class="nc" id="L394">  }</span>

  /**
   * Creates a new {@link net.dv8tion.jda.core.requests.RestAction RestAction} instance that will
   * apply &lt;b&gt;all&lt;/b&gt; changes that have been made to this manager instance. &lt;br&gt;
   * If no changes have been made this will simply return {@link
   * net.dv8tion.jda.core.requests.RestAction.EmptyRestAction EmptyRestAction}.
   *
   * &lt;p&gt;Before applying new changes it is recommended to call {@link #reset()} to reset previous
   * changes. &lt;br&gt;
   * This is automatically called if this method returns successfully.
   *
   * &lt;p&gt;Possible {@link net.dv8tion.jda.core.requests.ErrorResponse ErrorResponses} for this update
   * include the following:
   *
   * &lt;ul&gt;
   *   &lt;li&gt;{@link net.dv8tion.jda.core.requests.ErrorResponse#UNKNOWN_GUILD UNKNOWN_GUILD} &lt;br&gt;
   *       If the Guild was deleted before finishing the task
   *   &lt;li&gt;{@link net.dv8tion.jda.core.requests.ErrorResponse#MISSING_PERMISSIONS
   *       MISSING_PERMISSIONS} &lt;br&gt;
   *       If the currently logged in account loses the {@link
   *       net.dv8tion.jda.core.Permission#MANAGE_SERVER MANAGE_SERVER Permission} before finishing
   *       the task
   * &lt;/ul&gt;
   *
   * @throws net.dv8tion.jda.core.exceptions.InsufficientPermissionException If the currently logged
   *     in account does not have the Permission {@link
   *     net.dv8tion.jda.core.Permission#MANAGE_SERVER MANAGE_SERVER} in the underlying {@link
   *     net.dv8tion.jda.core.entities.Guild Guild}
   * @throws net.dv8tion.jda.core.exceptions.GuildUnavailableException If the Guild is temporarily
   *     not {@link net.dv8tion.jda.core.entities.Guild#isAvailable() available}
   * @return {@link net.dv8tion.jda.core.requests.restaction.AuditableRestAction
   *     AuditableRestAction} &lt;br&gt;
   *     Applies all changes that have been made in a single api-call.
   */
  public AuditableRestAction&lt;Void&gt; update() {
<span class="nc" id="L430">    checkAvailable();</span>
<span class="nc" id="L431">    checkPermission(Permission.MANAGE_SERVER);</span>

<span class="nc bnc" id="L433" title="All 2 branches missed.">    if (!needToUpdate()) return new AuditableRestAction.EmptyRestAction&lt;&gt;(getJDA(), null);</span>

<span class="nc" id="L435">    JSONObject body = new JSONObject().put(&quot;name&quot;, guild.getName());</span>
<span class="nc bnc" id="L436" title="All 2 branches missed.">    if (name.shouldUpdate()) body.put(&quot;name&quot;, name.getValue());</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">    if (region.shouldUpdate()) body.put(&quot;region&quot;, region.getValue().getKey());</span>
<span class="nc bnc" id="L438" title="All 2 branches missed.">    if (timeout.shouldUpdate()) body.put(&quot;afk_timeout&quot;, timeout.getValue().getSeconds());</span>
<span class="nc bnc" id="L439" title="All 2 branches missed.">    if (icon.shouldUpdate())</span>
<span class="nc bnc" id="L440" title="All 2 branches missed.">      body.put(&quot;icon&quot;, icon.getValue() == null ? JSONObject.NULL : icon.getValue().getEncoding());</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">    if (splash.shouldUpdate())</span>
<span class="nc" id="L442">      body.put(</span>
<span class="nc bnc" id="L443" title="All 2 branches missed.">          &quot;splash&quot;, splash.getValue() == null ? JSONObject.NULL : splash.getValue().getEncoding());</span>
<span class="nc bnc" id="L444" title="All 2 branches missed.">    if (afkChannel.shouldUpdate())</span>
<span class="nc" id="L445">      body.put(</span>
          &quot;afk_channel_id&quot;,
<span class="nc bnc" id="L447" title="All 2 branches missed.">          afkChannel.getValue() == null ? JSONObject.NULL : afkChannel.getValue().getId());</span>
<span class="nc bnc" id="L448" title="All 2 branches missed.">    if (systemChannel.shouldUpdate())</span>
<span class="nc" id="L449">      body.put(</span>
          &quot;system_channel_id&quot;,
<span class="nc bnc" id="L451" title="All 2 branches missed.">          systemChannel.getValue() == null ? JSONObject.NULL : systemChannel.getValue().getId());</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">    if (verificationLevel.shouldUpdate())</span>
<span class="nc" id="L453">      body.put(&quot;verification_level&quot;, verificationLevel.getValue().getKey());</span>
<span class="nc bnc" id="L454" title="All 2 branches missed.">    if (defaultNotificationLevel.shouldUpdate())</span>
<span class="nc" id="L455">      body.put(&quot;default_notification_level&quot;, defaultNotificationLevel.getValue().getKey());</span>
<span class="nc bnc" id="L456" title="All 2 branches missed.">    if (mfaLevel.shouldUpdate()) body.put(&quot;mfa_level&quot;, mfaLevel.getValue().getKey());</span>
<span class="nc bnc" id="L457" title="All 2 branches missed.">    if (explicitContentLevel.shouldUpdate())</span>
<span class="nc" id="L458">      body.put(&quot;explicit_content_filter&quot;, explicitContentLevel.getValue().getKey());</span>

<span class="nc" id="L460">    reset(); // now that we've built our JSON object, reset the manager back to the non-modified</span>
    // state
<span class="nc" id="L462">    Route.CompiledRoute route = Route.Guilds.MODIFY_GUILD.compile(guild.getId());</span>
<span class="nc" id="L463">    return new AuditableRestAction&lt;Void&gt;(guild.getJDA(), route, body) {</span>
      @Override
      protected void handleResponse(Response response, Request&lt;Void&gt; request) {
<span class="nc bnc" id="L466" title="All 2 branches missed.">        if (response.isOk()) request.onSuccess(null);</span>
<span class="nc" id="L467">        else request.onFailure(response);</span>
<span class="nc" id="L468">      }</span>
    };
  }

  protected boolean needToUpdate() {
<span class="nc bnc" id="L473" title="All 2 branches missed.">    return name.shouldUpdate()</span>
<span class="nc bnc" id="L474" title="All 2 branches missed.">        || region.shouldUpdate()</span>
<span class="nc bnc" id="L475" title="All 2 branches missed.">        || timeout.shouldUpdate()</span>
<span class="nc bnc" id="L476" title="All 2 branches missed.">        || icon.shouldUpdate()</span>
<span class="nc bnc" id="L477" title="All 2 branches missed.">        || splash.shouldUpdate()</span>
<span class="nc bnc" id="L478" title="All 2 branches missed.">        || afkChannel.shouldUpdate()</span>
<span class="nc bnc" id="L479" title="All 2 branches missed.">        || systemChannel.shouldUpdate()</span>
<span class="nc bnc" id="L480" title="All 2 branches missed.">        || verificationLevel.shouldUpdate()</span>
<span class="nc bnc" id="L481" title="All 2 branches missed.">        || defaultNotificationLevel.shouldUpdate()</span>
<span class="nc bnc" id="L482" title="All 2 branches missed.">        || mfaLevel.shouldUpdate()</span>
<span class="nc bnc" id="L483" title="All 2 branches missed.">        || explicitContentLevel.shouldUpdate();</span>
  }

  protected void checkAvailable() {
<span class="nc bnc" id="L487" title="All 2 branches missed.">    if (!guild.isAvailable()) throw new GuildUnavailableException();</span>
<span class="nc" id="L488">  }</span>

  protected void checkPermission(Permission perm) {
<span class="nc bnc" id="L491" title="All 2 branches missed.">    if (!guild.getSelfMember().hasPermission(perm)) throw new InsufficientPermissionException(perm);</span>
<span class="nc" id="L492">  }</span>

  protected void setupFields() {
<span class="nc" id="L495">    this.name =</span>
<span class="nc" id="L496">        new GuildField&lt;String&gt;(this, guild::getName) {</span>
          @Override
          public void checkValue(String value) {
<span class="nc" id="L499">            Checks.notNull(value, &quot;guild name&quot;);</span>
<span class="nc bnc" id="L500" title="All 4 branches missed.">            if (value.length() &lt; 2 || value.length() &gt; 100)</span>
<span class="nc" id="L501">              throw new IllegalArgumentException(</span>
                  &quot;Provided guild name must be 2 to 100 characters in length&quot;);
<span class="nc" id="L503">          }</span>
        };

<span class="nc" id="L506">    this.timeout =</span>
<span class="nc" id="L507">        new GuildField&lt;Guild.Timeout&gt;(this, guild::getAfkTimeout) {</span>
          @Override
          public void checkValue(Guild.Timeout value) {
<span class="nc" id="L510">            Checks.notNull(value, &quot;Timeout&quot;);</span>
<span class="nc" id="L511">          }</span>
        };

<span class="nc" id="L514">    this.icon =</span>
<span class="nc" id="L515">        new GuildField&lt;Icon&gt;(this, null) {</span>
          @Override
<span class="nc" id="L517">          public void checkValue(Icon value) {}</span>

          @Override
          public Icon getOriginalValue() {
<span class="nc" id="L521">            throw new UnsupportedOperationException(</span>
                &quot;Cannot easily provide the original Icon. Use Guild#getIconUrl() and download it yourself.&quot;);
          }

          @Override
          public boolean shouldUpdate() {
<span class="nc" id="L527">            return isSet();</span>
          }
        };

<span class="nc" id="L531">    this.splash =</span>
<span class="nc" id="L532">        new GuildField&lt;Icon&gt;(this, null) {</span>
          @Override
<span class="nc" id="L534">          public void checkValue(Icon value) {}</span>

          @Override
          public Icon getOriginalValue() {
<span class="nc" id="L538">            throw new UnsupportedOperationException(</span>
                &quot;Cannot easily provide the original Splash. Use Guild#getSplashUrl() and download it yourself.&quot;);
          }

          @Override
          public boolean shouldUpdate() {
<span class="nc" id="L544">            return isSet();</span>
          }
        };

<span class="nc" id="L548">    this.region =</span>
<span class="nc" id="L549">        new GuildField&lt;Region&gt;(this, guild::getRegion) {</span>
          @Override
          public void checkValue(Region value) {
<span class="nc" id="L552">            Checks.notNull(value, &quot;Region&quot;);</span>
<span class="nc bnc" id="L553" title="All 2 branches missed.">            if (value == Region.UNKNOWN)</span>
<span class="nc" id="L554">              throw new IllegalArgumentException(&quot;Cannot set Guild Region to UNKNOWN!&quot;);</span>
<span class="nc bnc" id="L555" title="All 4 branches missed.">            if (value.isVip() &amp;&amp; !guild.getFeatures().contains(&quot;VIP_REGIONS&quot;))</span>
<span class="nc" id="L556">              throw new IllegalArgumentException(&quot;VIP regions are not supported by this Guild&quot;);</span>
<span class="nc" id="L557">          }</span>
        };

<span class="nc" id="L560">    this.afkChannel =</span>
<span class="nc" id="L561">        new GuildField&lt;VoiceChannel&gt;(this, guild::getAfkChannel) {</span>
          @Override
          public void checkValue(VoiceChannel value) {
<span class="nc bnc" id="L564" title="All 4 branches missed.">            if (value != null &amp;&amp; !guild.equals(value.getGuild()))</span>
<span class="nc" id="L565">              throw new IllegalArgumentException(&quot;Provided AFK Channel is not from this Guild!&quot;);</span>
<span class="nc" id="L566">          }</span>
        };

<span class="nc" id="L569">    this.systemChannel =</span>
<span class="nc" id="L570">        new GuildField&lt;TextChannel&gt;(this, guild::getSystemChannel) {</span>
          @Override
          public void checkValue(TextChannel value) {
<span class="nc bnc" id="L573" title="All 4 branches missed.">            if (value != null &amp;&amp; !guild.equals(value.getGuild()))</span>
<span class="nc" id="L574">              throw new IllegalArgumentException(&quot;Provided system channel is not from this Guild!&quot;);</span>
<span class="nc" id="L575">          }</span>
        };

<span class="nc" id="L578">    this.verificationLevel =</span>
<span class="nc" id="L579">        new GuildField&lt;Guild.VerificationLevel&gt;(this, guild::getVerificationLevel) {</span>
          @Override
          public void checkValue(Guild.VerificationLevel value) {
<span class="nc" id="L582">            Checks.notNull(value, &quot;VerificationLevel&quot;);</span>
<span class="nc bnc" id="L583" title="All 2 branches missed.">            if (value == Guild.VerificationLevel.UNKNOWN)</span>
<span class="nc" id="L584">              throw new IllegalArgumentException(&quot;Cannot set Guild VerificationLevel to UNKNOWN&quot;);</span>
<span class="nc" id="L585">          }</span>
        };

<span class="nc" id="L588">    this.defaultNotificationLevel =</span>
<span class="nc" id="L589">        new GuildField&lt;Guild.NotificationLevel&gt;(this, guild::getDefaultNotificationLevel) {</span>
          @Override
          public void checkValue(Guild.NotificationLevel value) {
<span class="nc" id="L592">            Checks.notNull(value, &quot;NotificationLevel&quot;);</span>
<span class="nc bnc" id="L593" title="All 2 branches missed.">            if (value == Guild.NotificationLevel.UNKNOWN)</span>
<span class="nc" id="L594">              throw new IllegalArgumentException(&quot;Cannot set NotificationLevel to UNKNOWN&quot;);</span>
<span class="nc" id="L595">          }</span>
        };

<span class="nc" id="L598">    this.mfaLevel =</span>
<span class="nc" id="L599">        new GuildField&lt;Guild.MFALevel&gt;(this, guild::getRequiredMFALevel) {</span>
          @Override
          public void checkValue(Guild.MFALevel value) {
<span class="nc" id="L602">            Checks.notNull(value, &quot;MFALevel&quot;);</span>
<span class="nc bnc" id="L603" title="All 2 branches missed.">            if (value == Guild.MFALevel.UNKNOWN)</span>
<span class="nc" id="L604">              throw new IllegalArgumentException(&quot;Cannot set MFALevel to UNKNOWN&quot;);</span>
<span class="nc" id="L605">          }</span>
        };

<span class="nc" id="L608">    this.explicitContentLevel =</span>
<span class="nc" id="L609">        new GuildField&lt;Guild.ExplicitContentLevel&gt;(this, guild::getExplicitContentLevel) {</span>
          @Override
          public void checkValue(Guild.ExplicitContentLevel value) {
<span class="nc" id="L612">            Checks.notNull(value, &quot;ExplicitContentLevel&quot;);</span>
<span class="nc bnc" id="L613" title="All 2 branches missed.">            Checks.check(</span>
                value != Guild.ExplicitContentLevel.UNKNOWN,
                &quot;Cannot set ExplicitContentLevel to UNKNOWN&quot;);
<span class="nc" id="L616">          }</span>
        };
<span class="nc" id="L618">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>