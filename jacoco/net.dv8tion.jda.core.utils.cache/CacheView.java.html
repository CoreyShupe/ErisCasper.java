<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CacheView.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ErisCasper.java</a> &gt; <a href="index.source.html" class="el_package">net.dv8tion.jda.core.utils.cache</a> &gt; <span class="el_source">CacheView.java</span></div><h1>CacheView.java</h1><pre class="source lang-java linenums">/*
 *     Copyright 2015-2018 Austin Keener &amp; Michael Ritter &amp; Florian Spie√ü
 *     Copyright 2018-2018 &quot;Princess&quot; Lana Samson
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package net.dv8tion.jda.core.utils.cache;

import java.util.Collection;
import java.util.List;
import java.util.Set;
import java.util.function.Function;
import java.util.function.Supplier;
import java.util.stream.Collector;
import java.util.stream.Stream;
import net.dv8tion.jda.bot.utils.cache.ShardCacheView;
import net.dv8tion.jda.bot.utils.cache.impl.ShardCacheViewImpl;
import net.dv8tion.jda.core.entities.ISnowflake;
import net.dv8tion.jda.core.utils.Checks;
import net.dv8tion.jda.core.utils.cache.impl.AbstractCacheView;
import net.dv8tion.jda.core.utils.cache.impl.UnifiedCacheViewImpl;

/**
 * Read-only view on internal JDA cache of items. &lt;br&gt;
 * This can be useful to check information such as size without creating an immutable snapshot
 * first.
 *
 * @param  &lt;T&gt; The cache type
 */
public interface CacheView&lt;T&gt; extends Iterable&lt;T&gt; {
  /**
   * Creates an immutable snapshot of the current cache state. &lt;br&gt;
   * This will copy all elements contained in this cache into a list. &lt;br&gt;
   * This will be sorted for a {@link net.dv8tion.jda.core.utils.cache.impl.SortedSnowflakeCacheView
   * SortedSnowflakeCacheView}.
   *
   * @return Immutable list of cached elements
   */
  List&lt;T&gt; asList();

  /**
   * Creates an immutable snapshot of the current cache state. &lt;br&gt;
   * This will copy all elements contained in this cache into a set.
   *
   * @return Immutable set of cached elements
   */
  Set&lt;T&gt; asSet();

  /**
   * The current size of this cache &lt;br&gt;
   * This is a {@code long} as it may be a projected view of multiple caches (See {@link
   * net.dv8tion.jda.core.utils.cache.CacheView#all(java.util.function.Supplier)})
   *
   * &lt;p&gt;This is more efficient than creating a list or set snapshot first as it checks the size of
   * the internal cache directly.
   *
   * @return The current size of this cache
   */
  long size();

  /**
   * Whether the cache is empty
   *
   * &lt;p&gt;This is more efficient than creating a list or set snapshot first as it checks the size of
   * the internal cache directly. &lt;br&gt;
   * On a projected cache view this will simply look through all projected views and return false
   * the moment it finds one that is not empty.
   *
   * @return True, if this cache is currently empty
   */
  boolean isEmpty();

  /**
   * Creates an immutable list of all elements matching the given name. &lt;br&gt;
   * For a {@link net.dv8tion.jda.core.utils.cache.MemberCacheView MemberCacheView} this will check
   * the {@link net.dv8tion.jda.core.entities.Member#getEffectiveName() Effective Name} of the
   * cached members.
   *
   * @param name The name to check
   * @param ignoreCase Whether to ignore case when comparing names
   * @throws java.lang.IllegalArgumentException If the provided name is {@code null}
   * @return Immutable list of elements with the given name
   */
  List&lt;T&gt; getElementsByName(String name, boolean ignoreCase);

  /**
   * Creates an immutable list of all elements matching the given name. &lt;br&gt;
   * For a {@link net.dv8tion.jda.core.utils.cache.MemberCacheView MemberCacheView} this will check
   * the {@link net.dv8tion.jda.core.entities.Member#getEffectiveName() Effective Name} of the
   * cached members.
   *
   * @param name The name to check
   * @throws java.lang.IllegalArgumentException If the provided name is {@code null}
   * @return Immutable list of elements with the given name
   */
  default List&lt;T&gt; getElementsByName(String name) {
<span class="nc" id="L107">    return getElementsByName(name, false);</span>
  }

  /**
   * Creates a {@link java.util.stream.Stream Stream} of all cached elements. &lt;br&gt;
   * This will be sorted for a {@link net.dv8tion.jda.core.utils.cache.impl.SortedSnowflakeCacheView
   * SortedSnowflakeCacheView}.
   *
   * @return Stream of elements
   */
  Stream&lt;T&gt; stream();

  /**
   * Creates a parallel {@link java.util.stream.Stream Stream} of all cached elements. &lt;br&gt;
   * This will be sorted for a {@link net.dv8tion.jda.core.utils.cache.impl.SortedSnowflakeCacheView
   * SortedSnowflakeCacheView}.
   *
   * @return Parallel Stream of elements
   */
  Stream&lt;T&gt; parallelStream();

  /**
   * Collects all cached entities into a single Collection using the provided {@link
   * java.util.stream.Collector Collector}. Shortcut for {@code stream().collect(collector)}.
   *
   * @param collector The collector used to collect the elements
   * @param  &lt;R&gt; The output type
   * @param  &lt;A&gt; The accumulator type
   * @throws java.lang.IllegalArgumentException If the provided collector is {@code null}
   * @return Resulting collections
   */
  default &lt;R, A&gt; R collect(Collector&lt;? super T, A, R&gt; collector) {
<span class="nc" id="L139">    return stream().collect(collector);</span>
  }

  /**
   * Creates a combined {@link net.dv8tion.jda.core.utils.cache.CacheView CacheView} for all
   * provided CacheView implementations. This allows to combine cache of multiple JDA sessions or
   * Guilds.
   *
   * @param cacheViews Collection of {@link net.dv8tion.jda.core.utils.cache.CacheView CacheView}
   *     implementations
   * @param  &lt;E&gt; The target type of the projection
   * @return Combined CacheView spanning over all provided implementation instances
   */
  static &lt;E&gt; CacheView&lt;E&gt; all(Collection&lt;? extends CacheView&lt;E&gt;&gt; cacheViews) {
<span class="nc" id="L153">    Checks.noneNull(cacheViews, &quot;Collection&quot;);</span>
<span class="nc" id="L154">    return new UnifiedCacheViewImpl&lt;&gt;(cacheViews::stream);</span>
  }

  /**
   * Creates a combined {@link net.dv8tion.jda.core.utils.cache.CacheView CacheView} for all
   * provided CacheView implementations. This allows to combine cache of multiple JDA sessions or
   * Guilds.
   *
   * @param generator Stream generator of {@link net.dv8tion.jda.core.utils.cache.CacheView
   *     CacheView} implementations
   * @param  &lt;E&gt; The target type of the projection
   * @return Combined CacheView spanning over all provided implementation instances
   */
  static &lt;E&gt; CacheView&lt;E&gt; all(Supplier&lt;Stream&lt;CacheView&lt;E&gt;&gt;&gt; generator) {
<span class="nc" id="L168">    Checks.notNull(generator, &quot;Generator&quot;);</span>
<span class="nc" id="L169">    return new UnifiedCacheViewImpl&lt;&gt;(generator);</span>
  }

  /**
   * Creates a combined {@link net.dv8tion.jda.bot.utils.cache.ShardCacheView ShardCacheView} for
   * all provided ShardCacheView implementations.
   *
   * @param cacheViews Collection of {@link net.dv8tion.jda.bot.utils.cache.ShardCacheView
   *     ShardCacheView} implementations
   * @return Combined ShardCacheView spanning over all provided implementation instances
   */
  static ShardCacheView allShards(Collection&lt;ShardCacheView&gt; cacheViews) {
<span class="nc" id="L181">    Checks.noneNull(cacheViews, &quot;Collection&quot;);</span>
<span class="nc" id="L182">    return new ShardCacheViewImpl.UnifiedShardCacheViewImpl(cacheViews::stream);</span>
  }

  /**
   * Creates a combined {@link net.dv8tion.jda.bot.utils.cache.ShardCacheView ShardCacheView} for
   * all provided ShardCacheView implementations.
   *
   * @param generator Stream generator of {@link net.dv8tion.jda.bot.utils.cache.ShardCacheView
   *     ShardCacheView} implementations
   * @return Combined ShardCacheView spanning over all provided implementation instances
   */
  static ShardCacheView allShards(Supplier&lt;Stream&lt;ShardCacheView&gt;&gt; generator) {
<span class="nc" id="L194">    Checks.notNull(generator, &quot;Generator&quot;);</span>
<span class="nc" id="L195">    return new ShardCacheViewImpl.UnifiedShardCacheViewImpl(generator);</span>
  }

  /**
   * Creates a combined {@link net.dv8tion.jda.core.utils.cache.SnowflakeCacheView
   * SnowflakeCacheView} for all provided SnowflakeCacheView implementations. &lt;br&gt;
   * This allows to combine cache of multiple JDA sessions or Guilds.
   *
   * @param cacheViews Collection of {@link net.dv8tion.jda.core.utils.cache.SnowflakeCacheView
   *     SnowflakeCacheView} implementations
   * @param  &lt;E&gt; The target type of the chain
   * @return Combined SnowflakeCacheView spanning over all provided implementation instances
   */
  static &lt;E extends ISnowflake&gt; SnowflakeCacheView&lt;E&gt; allSnowflakes(
      Collection&lt;SnowflakeCacheView&lt;E&gt;&gt; cacheViews) {
<span class="nc" id="L210">    Checks.noneNull(cacheViews, &quot;Collection&quot;);</span>
<span class="nc" id="L211">    return new UnifiedCacheViewImpl.UnifiedSnowflakeCacheView&lt;&gt;(cacheViews::stream);</span>
  }

  /**
   * Creates a combined {@link net.dv8tion.jda.core.utils.cache.SnowflakeCacheView
   * SnowflakeCacheView} for all provided SnowflakeCacheView implementations. &lt;br&gt;
   * This allows to combine cache of multiple JDA sessions or Guilds.
   *
   * @param generator Stream generator of {@link net.dv8tion.jda.core.utils.cache.SnowflakeCacheView
   *     SnowflakeCacheView} implementations
   * @param  &lt;E&gt; The target type of the chain
   * @return Combined SnowflakeCacheView spanning over all provided implementation instances
   */
  static &lt;E extends ISnowflake&gt; SnowflakeCacheView&lt;E&gt; allSnowflakes(
      Supplier&lt;Stream&lt;SnowflakeCacheView&lt;E&gt;&gt;&gt; generator) {
<span class="nc" id="L226">    Checks.notNull(generator, &quot;Generator&quot;);</span>
<span class="nc" id="L227">    return new UnifiedCacheViewImpl.UnifiedSnowflakeCacheView&lt;&gt;(generator);</span>
  }

  /**
   * Creates a combined {@link UnifiedMemberCacheView UnifiedMemberCacheView} for all provided
   * MemberCacheView implementations. &lt;br&gt;
   * This allows to combine cache of multiple JDA sessions or Guilds.
   *
   * @param cacheViews Collection of {@link net.dv8tion.jda.core.utils.cache.MemberCacheView
   *     MemberCacheView} instances
   * @return Combined MemberCacheView spanning over all provided instances
   */
  static UnifiedMemberCacheView allMembers(Collection&lt;MemberCacheView&gt; cacheViews) {
<span class="nc" id="L240">    Checks.noneNull(cacheViews, &quot;Collection&quot;);</span>
<span class="nc" id="L241">    return new UnifiedCacheViewImpl.UnifiedMemberCacheViewImpl(cacheViews::stream);</span>
  }

  /**
   * Creates a combined {@link UnifiedMemberCacheView UnifiedMemberCacheView} for all provided
   * MemberCacheView implementations. &lt;br&gt;
   * This allows to combine cache of multiple JDA sessions or Guilds.
   *
   * @param generator Stream generator of {@link net.dv8tion.jda.core.utils.cache.MemberCacheView
   *     MemberCacheView} instances
   * @return Combined MemberCacheView spanning over all provided instances
   */
  static UnifiedMemberCacheView allMembers(Supplier&lt;Stream&lt;MemberCacheView&gt;&gt; generator) {
<span class="nc" id="L254">    Checks.notNull(generator, &quot;Generator&quot;);</span>
<span class="nc" id="L255">    return new UnifiedCacheViewImpl.UnifiedMemberCacheViewImpl(generator);</span>
  }

  /**
   * Basic implementation of {@link net.dv8tion.jda.core.utils.cache.CacheView CacheView} interface.
   * &lt;br&gt;
   * Using {@link gnu.trove.map.TLongObjectMap TLongObjectMap} to cache entities!
   *
   * @param &lt;T&gt; The type this should cache
   */
  class SimpleCacheView&lt;T&gt; extends AbstractCacheView&lt;T&gt; {
    public SimpleCacheView(Function&lt;T, String&gt; nameMapper) {
<span class="nc" id="L267">      super(nameMapper);</span>
<span class="nc" id="L268">    }</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>