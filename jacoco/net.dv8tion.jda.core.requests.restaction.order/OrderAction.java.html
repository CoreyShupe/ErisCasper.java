<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>OrderAction.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ErisCasper.java</a> &gt; <a href="index.source.html" class="el_package">net.dv8tion.jda.core.requests.restaction.order</a> &gt; <span class="el_source">OrderAction.java</span></div><h1>OrderAction.java</h1><pre class="source lang-java linenums">/*
 *     Copyright 2015-2018 Austin Keener &amp; Michael Ritter &amp; Florian Spie√ü
 *     Copyright 2018-2018 &quot;Princess&quot; Lana Samson
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package net.dv8tion.jda.core.requests.restaction.order;

import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;
import java.util.function.BooleanSupplier;
import net.dv8tion.jda.core.JDA;
import net.dv8tion.jda.core.requests.Request;
import net.dv8tion.jda.core.requests.Response;
import net.dv8tion.jda.core.requests.RestAction;
import net.dv8tion.jda.core.requests.Route;
import net.dv8tion.jda.core.utils.Checks;

/**
 * Extension of {@link net.dv8tion.jda.core.requests.RestAction RestAction} - Type: Void that allows
 * to modify the order of entities provided as an {@link java.util.ArrayList ArrayList}. &lt;br&gt;
 * This action contains a List or entities for the specified type {@code T} which can be moved
 * within the bounds but not removed, nor can any new entities be added.
 *
 * @param &lt;T&gt; The entity type for the {@link java.util.List List} of entities contained in the
 *     OrderAction's orderList
 * @param &lt;M&gt; The extension implementing the abstract operations of this OrderAction, this will be
 *     important for chaining convenience as it returns the specific implementation rather than a
 *     mask of this class. It allows us to implement chaining operations in this class instead of
 *     having to implement it in every inheriting class!
 * @since 3.0
 */
public abstract class OrderAction&lt;T, M extends OrderAction&lt;T, M&gt;&gt; extends RestAction&lt;Void&gt; {
  protected final List&lt;T&gt; orderList;
  protected final boolean ascendingOrder;
<span class="nc" id="L48">  protected int selectedPosition = -1;</span>

  /**
   * Creates a new OrderAction instance
   *
   * @param api JDA instance which is associated with the entities contained in the order list
   * @param route The {@link net.dv8tion.jda.core.requests.Route.CompiledRoute CompiledRoute} which
   *     is provided to the {@link RestAction#RestAction(JDA, Route.CompiledRoute,
   *     okhttp3.RequestBody) RestAction Constructor}
   */
  public OrderAction(JDA api, Route.CompiledRoute route) {
<span class="nc" id="L59">    this(api, true, route);</span>
<span class="nc" id="L60">  }</span>

  /**
   * Creates a new OrderAction instance
   *
   * @param api JDA instance which is associated with the entities contained in the order list
   * @param ascendingOrder Whether or not the order of items should be ascending
   * @param route The {@link net.dv8tion.jda.core.requests.Route.CompiledRoute CompiledRoute} which
   *     is provided to the {@link RestAction#RestAction(JDA, Route.CompiledRoute,
   *     okhttp3.RequestBody) RestAction Constructor}
   */
  public OrderAction(JDA api, boolean ascendingOrder, Route.CompiledRoute route) {
<span class="nc" id="L72">    super(api, route);</span>
<span class="nc" id="L73">    this.orderList = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L74">    this.ascendingOrder = ascendingOrder;</span>
<span class="nc" id="L75">  }</span>

  @Override
  public M setCheck(BooleanSupplier checks) {
<span class="nc" id="L79">    return (M) super.setCheck(checks);</span>
  }

  /**
   * Immutable List representing the currently selected order of entities in this OrderAction
   * instance
   *
   * @return Immutable List representing the current order
   */
  public List&lt;T&gt; getCurrentOrder() {
<span class="nc" id="L89">    return Collections.unmodifiableList(orderList);</span>
  }

  /**
   * Selects a new current entity at the specified index &lt;br&gt;
   * This index is in correlation to the {@link #getCurrentOrder() current order}
   *
   * @param selectedPosition The index for the new position that will be in focus for all
   *     modification operations
   * @throws java.lang.IllegalArgumentException If the provided position is out-of-bounds
   * @return The current OrderAction sub-implementation instance
   * @see #getSelectedPosition()
   * @see #getSelectedEntity()
   */
  public M selectPosition(int selectedPosition) {
<span class="nc" id="L104">    Checks.notNegative(selectedPosition, &quot;Provided selectedPosition&quot;);</span>
<span class="nc" id="L105">    Checks.check(</span>
<span class="nc bnc" id="L106" title="All 2 branches missed.">        selectedPosition &lt; orderList.size(),</span>
        &quot;Provided selectedPosition is too big and is out of bounds. selectedPosition: &quot;
            + selectedPosition);

<span class="nc" id="L110">    this.selectedPosition = selectedPosition;</span>

<span class="nc" id="L112">    return (M) this;</span>
  }

  /**
   * Selects a new current entity based on the index of the specified entity in the {@link
   * #getCurrentOrder() current order} &lt;br&gt;
   * This is a convenience function that uses {@link #selectPosition(int)} internally
   *
   * @param selectedEntity The entity for the new position that will be in focus for all
   *     modification operations
   * @return The current OrderAction sub-implementation instance
   * @see #selectPosition(int)
   * @see #getSelectedPosition()
   * @see #getSelectedEntity()
   */
  public M selectPosition(T selectedEntity) {
<span class="nc" id="L128">    Checks.notNull(selectedEntity, &quot;Channel&quot;);</span>
<span class="nc" id="L129">    validateInput(selectedEntity);</span>

<span class="nc" id="L131">    return selectPosition(orderList.indexOf(selectedEntity));</span>
  }

  /**
   * The currently selected position that is in focus for all modification operations of this
   * OrderAction instance
   *
   * @return The currently selected index, or -1 if no position has been selected yet
   */
  public int getSelectedPosition() {
<span class="nc" id="L141">    return selectedPosition;</span>
  }

  /**
   * The entity which is currently at the {@link #getSelectedPosition() selected position}
   *
   * @throws java.lang.IllegalStateException If no entity has been selected yet
   * @return The currently selected entity
   */
  public T getSelectedEntity() {
<span class="nc bnc" id="L151" title="All 2 branches missed.">    if (selectedPosition == -1)</span>
<span class="nc" id="L152">      throw new IllegalStateException(&quot;No position has been selected yet&quot;);</span>

<span class="nc" id="L154">    return orderList.get(selectedPosition);</span>
  }

  /**
   * Moves the currently selected entity {@code amount} positions &lt;b&gt;UP&lt;/b&gt; in order by pushing all
   * entities down by one position.
   *
   * @param amount The amount of positions that should be moved
   * @throws java.lang.IllegalStateException If no entity has been selected yet
   * @throws java.lang.IllegalArgumentException If the specified amount would cause the entity to go
   *     out-of-bounds
   * @return The current OrderAction sub-implementation instance
   * @see #moveTo(int)
   */
  public M moveUp(int amount) {
<span class="nc" id="L169">    Checks.notNegative(amount, &quot;Provided amount&quot;);</span>
<span class="nc bnc" id="L170" title="All 2 branches missed.">    if (selectedPosition == -1)</span>
<span class="nc" id="L171">      throw new IllegalStateException(</span>
          &quot;Cannot move until an item has been selected. Use #selectPosition first.&quot;);
<span class="nc bnc" id="L173" title="All 2 branches missed.">    if (ascendingOrder) {</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">      Checks.check(</span>
          selectedPosition - amount &gt;= 0,
          &quot;Amount provided to move up is too large and would be out of bounds.&quot;
              + &quot;Selected position: &quot;
              + selectedPosition
              + &quot; Amount: &quot;
              + amount
              + &quot; Largest Position: &quot;
<span class="nc" id="L182">              + orderList.size());</span>
    } else {
<span class="nc" id="L184">      Checks.check(</span>
<span class="nc bnc" id="L185" title="All 2 branches missed.">          selectedPosition + amount &lt; orderList.size(),</span>
          &quot;Amount provided to move up is too large and would be out of bounds.&quot;
              + &quot;Selected position: &quot;
              + selectedPosition
              + &quot; Amount: &quot;
              + amount
              + &quot; Largest Position: &quot;
<span class="nc" id="L192">              + orderList.size());</span>
    }

<span class="nc bnc" id="L195" title="All 2 branches missed.">    if (ascendingOrder) return moveTo(selectedPosition - amount);</span>
<span class="nc" id="L196">    else return moveTo(selectedPosition + amount);</span>
  }

  /**
   * Moves the currently selected entity {@code amount} positions &lt;b&gt;DOWN&lt;/b&gt; in order by pushing
   * all entities up by one position.
   *
   * @param amount The amount of positions that should be moved
   * @throws java.lang.IllegalStateException If no entity has been selected yet
   * @throws java.lang.IllegalArgumentException If the specified amount would cause the entity to go
   *     out-of-bounds
   * @return The current OrderAction sub-implementation instance
   * @see #moveTo(int)
   */
  public M moveDown(int amount) {
<span class="nc" id="L211">    Checks.notNegative(amount, &quot;Provided amount&quot;);</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">    if (selectedPosition == -1)</span>
<span class="nc" id="L213">      throw new IllegalStateException(</span>
          &quot;Cannot move until an item has been selected. Use #selectPosition first.&quot;);

<span class="nc bnc" id="L216" title="All 2 branches missed.">    if (ascendingOrder) {</span>
<span class="nc" id="L217">      Checks.check(</span>
<span class="nc bnc" id="L218" title="All 2 branches missed.">          selectedPosition + amount &lt; orderList.size(),</span>
          &quot;Amount provided to move down is too large and would be out of bounds.&quot;
              + &quot;Selected position: &quot;
              + selectedPosition
              + &quot; Amount: &quot;
              + amount
              + &quot; Largest Position: &quot;
<span class="nc" id="L225">              + orderList.size());</span>
    } else {
<span class="nc" id="L227">      Checks.check(</span>
<span class="nc bnc" id="L228" title="All 2 branches missed.">          selectedPosition - amount &gt;= orderList.size(),</span>
          &quot;Amount provided to move down is too large and would be out of bounds.&quot;
              + &quot;Selected position: &quot;
              + selectedPosition
              + &quot; Amount: &quot;
              + amount
              + &quot; Largest Position: &quot;
<span class="nc" id="L235">              + orderList.size());</span>
    }

<span class="nc bnc" id="L238" title="All 2 branches missed.">    if (ascendingOrder) return moveTo(selectedPosition + amount);</span>
<span class="nc" id="L239">    else return moveTo(selectedPosition - amount);</span>
  }

  /**
   * Moves the currently selected entity to the specified position (0 based index). All entities are
   * moved in the direction of the left &lt;i&gt;hole&lt;/i&gt; to fill the gap.
   *
   * @param position The new not-negative position for the currently selected entity
   * @throws java.lang.IllegalStateException If no entity has been selected yet
   * @throws java.lang.IllegalArgumentException If the specified position is out-of-bounds
   * @return The current OrderAction sub-implementation instance
   * @see #moveDown(int)
   * @see #moveUp(int)
   */
  public M moveTo(int position) {
<span class="nc" id="L254">    Checks.notNegative(position, &quot;Provided position&quot;);</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">    Checks.check(position &lt; orderList.size(), &quot;Provided position is too big and is out of bounds.&quot;);</span>

<span class="nc" id="L257">    T selectedItem = orderList.remove(selectedPosition);</span>
<span class="nc" id="L258">    orderList.add(position, selectedItem);</span>

<span class="nc" id="L260">    return (M) this;</span>
  }

  /**
   * Swaps the currently selected entity with the entity located at the specified position. No other
   * entities are affected by this operation.
   *
   * @param swapPosition 0 based index of target position
   * @throws java.lang.IllegalStateException If no entity has been selected yet
   * @throws java.lang.IllegalArgumentException If the specified position is out-of-bounds
   * @return The current OrderAction sub-implementation instance
   */
  public M swapPosition(int swapPosition) {
<span class="nc" id="L273">    Checks.notNegative(swapPosition, &quot;Provided swapPosition&quot;);</span>
<span class="nc" id="L274">    Checks.check(</span>
<span class="nc bnc" id="L275" title="All 2 branches missed.">        swapPosition &lt; orderList.size(),</span>
        &quot;Provided swapPosition is too big and is out of bounds. swapPosition: &quot; + swapPosition);

<span class="nc" id="L278">    T selectedItem = orderList.get(selectedPosition);</span>
<span class="nc" id="L279">    T swapItem = orderList.get(swapPosition);</span>
<span class="nc" id="L280">    orderList.set(swapPosition, selectedItem);</span>
<span class="nc" id="L281">    orderList.set(selectedPosition, swapItem);</span>

<span class="nc" id="L283">    return (M) this;</span>
  }

  /**
   * Swaps the currently selected entity with the specified entity. No other entities are affected
   * by this operation.
   *
   * @param swapEntity Target entity to switch positions with
   * @throws java.lang.IllegalStateException If no entity has been selected yet
   * @throws java.lang.IllegalArgumentException If the specified position is out-of-bounds, or if
   *     the target entity is {@code null} or not available in this order action implementation
   * @return The current OrderAction sub-implementation instance
   * @see #swapPosition(int)
   */
  public M swapPosition(T swapEntity) {
<span class="nc" id="L298">    Checks.notNull(swapEntity, &quot;Provided swapEntity&quot;);</span>
<span class="nc" id="L299">    validateInput(swapEntity);</span>

<span class="nc" id="L301">    return swapPosition(orderList.indexOf(swapEntity));</span>
  }

  /**
   * Reverses the {@link #getCurrentOrder() current order} by using {@link
   * java.util.Collections#reverse(java.util.List) Collections.reverse(orderList)}
   *
   * @return The current OrderAction sub-implementation instance
   * @see java.util.Collections#reverse(java.util.List)
   */
  public M reverseOrder() {
<span class="nc" id="L312">    Collections.reverse(this.orderList);</span>
<span class="nc" id="L313">    return (M) this;</span>
  }

  /**
   * Shuffles the {@link #getCurrentOrder() current order} by using {@link
   * java.util.Collections#shuffle(java.util.List) Collections.shuffle(orderList)}
   *
   * @return The current OrderAction sub-implementation instance
   * @see java.util.Collections#shuffle(java.util.List)
   */
  public M shuffleOrder() {
<span class="nc" id="L324">    Collections.shuffle(this.orderList);</span>
<span class="nc" id="L325">    return (M) this;</span>
  }

  /**
   * Sorts the {@link #getCurrentOrder() current order} based on the specified {@link
   * java.util.Comparator Comparator}. &lt;br&gt;
   * Using {@link java.util.ArrayList#sort(java.util.Comparator) ArrayList.sort(comparator)}
   *
   * @param comparator Comparator used to sort the current order
   * @throws java.lang.IllegalArgumentException If the specified comparator is {@code null}
   * @return The current OrderAction sub-implementation instance
   * @see java.util.ArrayList#sort(java.util.Comparator)
   */
  public M sortOrder(final Comparator&lt;T&gt; comparator) {
<span class="nc" id="L339">    Checks.notNull(comparator, &quot;Provided comparator&quot;);</span>

<span class="nc" id="L341">    this.orderList.sort(comparator);</span>
<span class="nc" id="L342">    return (M) this;</span>
  }

  @Override
  protected void handleResponse(Response response, Request&lt;Void&gt; request) {
<span class="nc bnc" id="L347" title="All 2 branches missed.">    if (response.isOk()) request.onSuccess(null);</span>
<span class="nc" id="L348">    else request.onFailure(response);</span>
<span class="nc" id="L349">  }</span>

  protected abstract void validateInput(T entity);
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>