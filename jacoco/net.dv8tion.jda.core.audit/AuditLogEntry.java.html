<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AuditLogEntry.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ErisCasper.java</a> &gt; <a href="index.source.html" class="el_package">net.dv8tion.jda.core.audit</a> &gt; <span class="el_source">AuditLogEntry.java</span></div><h1>AuditLogEntry.java</h1><pre class="source lang-java linenums">/*
 *     Copyright 2015-2018 Austin Keener &amp; Michael Ritter &amp; Florian Spie√ü
 *     Copyright 2018-2018 &quot;Princess&quot; Lana Samson
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package net.dv8tion.jda.core.audit;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Map;
import net.dv8tion.jda.core.JDA;
import net.dv8tion.jda.core.entities.Guild;
import net.dv8tion.jda.core.entities.ISnowflake;
import net.dv8tion.jda.core.entities.User;
import net.dv8tion.jda.core.entities.impl.GuildImpl;
import net.dv8tion.jda.core.entities.impl.UserImpl;
import net.dv8tion.jda.core.utils.Checks;

/**
 * Single entry for an {@link
 * net.dv8tion.jda.core.requests.restaction.pagination.AuditLogPaginationAction
 * AuditLogPaginationAction}. &lt;br&gt;
 * This entry contains all options/changes and details for the action that was logged by the {@link
 * net.dv8tion.jda.core.entities.Guild Guild} audit-logs.
 */
public class AuditLogEntry implements ISnowflake {

  protected final long id;
  protected final long targetId;
  protected final GuildImpl guild;
  protected final UserImpl user;
  protected final String reason;

  protected final Map&lt;String, AuditLogChange&gt; changes;
  protected final Map&lt;String, Object&gt; options;
  protected final ActionType type;

  public AuditLogEntry(
      ActionType type,
      long id,
      long targetId,
      GuildImpl guild,
      UserImpl user,
      String reason,
      Map&lt;String, AuditLogChange&gt; changes,
<span class="nc" id="L58">      Map&lt;String, Object&gt; options) {</span>
<span class="nc" id="L59">    this.type = type;</span>
<span class="nc" id="L60">    this.id = id;</span>
<span class="nc" id="L61">    this.targetId = targetId;</span>
<span class="nc" id="L62">    this.guild = guild;</span>
<span class="nc" id="L63">    this.user = user;</span>
<span class="nc" id="L64">    this.reason = reason;</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">    this.changes =</span>
<span class="nc bnc" id="L66" title="All 2 branches missed.">        changes != null &amp;&amp; !changes.isEmpty()</span>
<span class="nc" id="L67">            ? Collections.unmodifiableMap(changes)</span>
<span class="nc" id="L68">            : Collections.emptyMap();</span>
<span class="nc bnc" id="L69" title="All 2 branches missed.">    this.options =</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">        options != null &amp;&amp; !options.isEmpty()</span>
<span class="nc" id="L71">            ? Collections.unmodifiableMap(options)</span>
<span class="nc" id="L72">            : Collections.emptyMap();</span>
<span class="nc" id="L73">  }</span>

  @Override
  public long getIdLong() {
<span class="nc" id="L77">    return id;</span>
  }

  /**
   * The id for the target entity. &lt;br&gt;
   * This references an entity based on the {@link net.dv8tion.jda.core.audit.TargetType TargetType}
   * which is specified by {@link #getTargetType()}!
   *
   * @return The target id
   */
  public long getTargetIdLong() {
<span class="nc" id="L88">    return targetId;</span>
  }

  /**
   * The id for the target entity. &lt;br&gt;
   * This references an entity based on the {@link net.dv8tion.jda.core.audit.TargetType TargetType}
   * which is specified by {@link #getTargetType()}!
   *
   * @return The target id
   */
  public String getTargetId() {
<span class="nc" id="L99">    return Long.toUnsignedString(targetId);</span>
  }

  /**
   * The {@link net.dv8tion.jda.core.entities.Guild Guild} this audit-log entry refers to
   *
   * @return The Guild instance
   */
  public Guild getGuild() {
<span class="nc" id="L108">    return guild;</span>
  }

  /**
   * The {@link net.dv8tion.jda.core.entities.User User} responsible for this action.
   *
   * @return The User instance
   */
  public User getUser() {
<span class="nc" id="L117">    return user;</span>
  }

  /**
   * The optional reason why this action was executed.
   *
   * @return Possibly-null reason String
   */
  public String getReason() {
<span class="nc" id="L126">    return reason;</span>
  }

  /**
   * The corresponding JDA instance of the referring Guild
   *
   * @return The corresponding JDA instance
   */
  public JDA getJDA() {
<span class="nc" id="L135">    return guild.getJDA();</span>
  }

  /**
   * Key-Value {@link java.util.Map Map} containing all {@link AuditLogChange AuditLogChanges} made
   * in this entry. The keys for the returned map are case-insensitive keys defined in the regarding
   * AuditLogChange value. &lt;br&gt;
   * To iterate only the changes you can use {@link java.util.Map#values() Map.values()}!
   *
   * @return Key-Value Map of changes
   */
  public Map&lt;String, AuditLogChange&gt; getChanges() {
<span class="nc" id="L147">    return changes;</span>
  }

  /**
   * Shortcut to &lt;code&gt;{@link #getChanges() getChanges()}.get(key)&lt;/code&gt; lookup! &lt;br&gt;
   * This lookup is case-insensitive!
   *
   * @param key The {@link net.dv8tion.jda.core.audit.AuditLogKey AuditLogKey} to look for
   * @return Possibly-null value corresponding to the specified key
   */
  public AuditLogChange getChangeByKey(final AuditLogKey key) {
<span class="nc bnc" id="L158" title="All 2 branches missed.">    return key == null ? null : getChangeByKey(key.getKey());</span>
  }

  /**
   * Shortcut to &lt;code&gt;{@link #getChanges() getChanges()}.get(key)&lt;/code&gt; lookup! &lt;br&gt;
   * This lookup is case-insensitive!
   *
   * @param key The key to look for
   * @return Possibly-null value corresponding to the specified key
   */
  public AuditLogChange getChangeByKey(final String key) {
<span class="nc" id="L169">    return changes.get(key);</span>
  }

  /**
   * Filters all changes by the specified keys
   *
   * @param keys Varargs {@link net.dv8tion.jda.core.audit.AuditLogKey AuditLogKeys} to look for
   * @throws java.lang.IllegalArgumentException If provided with null array
   * @return Possibly-empty, never-null immutable list of {@link AuditLogChange AuditLogChanges}
   */
  public List&lt;AuditLogChange&gt; getChangesForKeys(AuditLogKey... keys) {
<span class="nc" id="L180">    Checks.notNull(keys, &quot;Keys&quot;);</span>
<span class="nc" id="L181">    List&lt;AuditLogChange&gt; changes = new ArrayList&lt;&gt;(keys.length);</span>
<span class="nc bnc" id="L182" title="All 2 branches missed.">    for (AuditLogKey key : keys) {</span>
<span class="nc" id="L183">      AuditLogChange change = getChangeByKey(key);</span>
<span class="nc bnc" id="L184" title="All 2 branches missed.">      if (change != null) changes.add(change);</span>
    }
<span class="nc" id="L186">    return Collections.unmodifiableList(changes);</span>
  }

  /**
   * Key-Value {@link java.util.Map Map} containing all Options made in this entry. The keys for the
   * returned map are case-insensitive keys defined in the regarding AuditLogChange value. &lt;br&gt;
   * To iterate only the changes you can use {@link java.util.Map#values() Map.values()}!
   *
   * &lt;p&gt;Options may include secondary targets or details that do not qualify as &quot;change&quot;. &lt;br&gt;
   * An example of that would be the {@code member} option for {@link
   * net.dv8tion.jda.core.audit.ActionType#CHANNEL_OVERRIDE_UPDATE CHANNEL_OVERRIDE_UPDATE}
   * containing the user_id of a {@link net.dv8tion.jda.core.entities.Member Member}.
   *
   * @return Key-Value Map of changes
   */
  public Map&lt;String, Object&gt; getOptions() {
<span class="nc" id="L202">    return options;</span>
  }

  /**
   * Shortcut to &lt;code&gt;{@link #getOptions() getOptions()}.get(name)&lt;/code&gt; lookup! &lt;br&gt;
   * This lookup is case-insensitive!
   *
   * @param  &lt;T&gt; The expected type for this option &lt;br&gt;
   *     Will be used for casting
   * @param name The field name to look for
   * @throws java.lang.ClassCastException If the type-cast failed for the generic type.
   * @return Possibly-null value corresponding to the specified key
   */
  @SuppressWarnings(&quot;unchecked&quot;)
  public &lt;T&gt; T getOptionByName(String name) {
<span class="nc" id="L217">    return (T) options.get(name);</span>
  }

  /**
   * Shortcut to &lt;code&gt;{@link #getOptions() getOptions()}.get(name)&lt;/code&gt; lookup!
   *
   * @param  &lt;T&gt; The expected type for this option &lt;br&gt;
   *     Will be used for casting
   * @param option The {@link net.dv8tion.jda.core.audit.AuditLogOption AuditLogOption}
   * @throws java.lang.ClassCastException If the type-cast failed for the generic type.
   * @throws java.lang.IllegalArgumentException If provided with {@code null} option.
   * @return Possibly-null value corresponding to the specified option constant
   */
  public &lt;T&gt; T getOption(AuditLogOption option) {
<span class="nc" id="L231">    Checks.notNull(option, &quot;Option&quot;);</span>
<span class="nc" id="L232">    return getOptionByName(option.getKey());</span>
  }

  /**
   * Constructs a filtered, immutable list of options corresponding to the provided {@link
   * net.dv8tion.jda.core.audit.AuditLogOption AuditLogOptions}. &lt;br&gt;
   * This will exclude options with {@code null} values!
   *
   * @param options The not-null {@link net.dv8tion.jda.core.audit.AuditLogOption AuditLogOptions}
   *     which will be used to gather option values via {@link #getOption(AuditLogOption)
   *     getOption(AuditLogOption)}!
   * @throws java.lang.IllegalArgumentException If provided with null options
   * @return Unmodifiable list of representative values
   */
  public List&lt;Object&gt; getOptions(AuditLogOption... options) {
<span class="nc" id="L247">    Checks.notNull(options, &quot;Options&quot;);</span>
<span class="nc" id="L248">    List&lt;Object&gt; items = new ArrayList&lt;&gt;(options.length);</span>
<span class="nc bnc" id="L249" title="All 2 branches missed.">    for (AuditLogOption option : options) {</span>
<span class="nc" id="L250">      Object obj = getOption(option);</span>
<span class="nc bnc" id="L251" title="All 2 branches missed.">      if (obj != null) items.add(obj);</span>
    }
<span class="nc" id="L253">    return Collections.unmodifiableList(items);</span>
  }

  /**
   * The {@link net.dv8tion.jda.core.audit.ActionType ActionType} defining what auditable Action is
   * referred to by this entry.
   *
   * @return The {@link net.dv8tion.jda.core.audit.ActionType ActionType}
   */
  public ActionType getType() {
<span class="nc" id="L263">    return type;</span>
  }

  /**
   * The {@link net.dv8tion.jda.core.audit.TargetType TargetType} defining what kind of entity was
   * targeted by this action. &lt;br&gt;
   * Shortcut for {@code getType().getTargetType()}
   *
   * @return The {@link net.dv8tion.jda.core.audit.TargetType TargetType}
   */
  public TargetType getTargetType() {
<span class="nc" id="L274">    return type.getTargetType();</span>
  }

  @Override
  public int hashCode() {
<span class="nc" id="L279">    return Long.hashCode(id);</span>
  }

  @Override
  public boolean equals(Object obj) {
<span class="nc bnc" id="L284" title="All 2 branches missed.">    if (!(obj instanceof AuditLogEntry)) return false;</span>
<span class="nc" id="L285">    AuditLogEntry other = (AuditLogEntry) obj;</span>
<span class="nc bnc" id="L286" title="All 4 branches missed.">    return other.id == id &amp;&amp; other.targetId == targetId;</span>
  }

  @Override
  public String toString() {
<span class="nc" id="L291">    return &quot;ALE:&quot; + type + &quot;(ID:&quot; + id + &quot; / TID:&quot; + targetId + &quot; / &quot; + guild + ')';</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>